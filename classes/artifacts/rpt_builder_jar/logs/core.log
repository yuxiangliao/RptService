2019-07-03 18:26:55.031  INFO 73664 --- [restartedMain] com.inhe.rpt.RptServiceApplication       : Starting RptServiceApplication on INHE0159 with PID 73664 (E:\INHEMETER\Projects\SMART_VEND\STD_STS6\RptService\classes\artifacts\rpt_builder_jar\rpt_builder.jar started by INHE0159 in E:\INHEMETER\Projects\SMART_VEND\STD_STS6\RptService\classes\artifacts\rpt_builder_jar)
2019-07-03 18:26:55.075  INFO 73664 --- [restartedMain] com.inhe.rpt.RptServiceApplication       : No active profile set, falling back to default profiles: default
2019-07-03 18:26:55.246  INFO 73664 --- [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2019-07-03 18:26:55.264  INFO 73664 --- [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2019-07-03 18:26:58.215  INFO 73664 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9888 (http)
2019-07-03 18:26:58.311  INFO 73664 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2019-07-03 18:26:58.312  INFO 73664 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.16]
2019-07-03 18:26:58.324  INFO 73664 --- [restartedMain] o.a.catalina.core.AprLifecycleListener   : The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: [C:\ProgramData\Oracle\Java\javapath;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\ProgramData\Oracle\Java\javapath;E:\instantclient_11_2;C:\Program Files (x86)\Embarcadero\RAD Studio\7.0\bin;C:\Users\Public\Documents\RAD Studio\7.0\Bpl;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program Files\TortoiseSVN\bin;D:\Program Files\Git\cmd;F:\xampp\php;C:\ProgramData\ComposerSetup\bin;D:\Eclipse\tomcat\bin;D:\Eclipse\tomcat\lib;C:\WINDOWS\System32\OpenSSH\;E:\INHEMETER\SMARTMIS\website\Source\mysql5\bin;F:\node-v10.7.0-win-x64;F:\xampp\redis;D:\Program Files (x86)\Rational\common;D:\instantclient_11_2;C:\Program Files\Java\jdk1.8.0_91\bin\;F:\laravel\sts-bundle\apache-activemq-5.15.7\bin;F:\rocketmq;F:\rocketmq\apache-maven-3.6.0\bin\;C:\Program Files\Java\jdk1.8.0_91\jre\bin;C:\Program Files\OpenSSL-Win64\bin;C:\Users\liao\AppData\Local\Microsoft\WindowsApps;C:\Users\liao\AppData\Roaming\Composer\vendor\bin;D:\Program Files\Microsoft VS Code\bin;.]
2019-07-03 18:26:58.570  INFO 73664 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2019-07-03 18:26:58.575  INFO 73664 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 3277 ms
2019-07-03 18:27:00.004  INFO 73664 --- [restartedMain] o.s.s.c.ThreadPoolTaskScheduler          : Initializing ExecutorService 'threadPoolTaskScheduler'
2019-07-03 18:27:00.539  WARN 73664 --- [restartedMain] ion$DefaultTemplateResolverConfiguration : Cannot find template location: classpath:/templates/ (please add some templates or check your Thymeleaf configuration)
2019-07-03 18:27:00.828  INFO 73664 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2019-07-03 18:27:00.947  INFO 73664 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9888 (http) with context path ''
2019-07-03 18:27:00.983  INFO 73664 --- [restartedMain] com.inhe.rpt.RptServiceApplication       : Started RptServiceApplication in 8.128 seconds (JVM running for 9.474)
2019-07-03 18:27:00.995  INFO 73664 --- [restartedMain] com.inhe.rpt.controllers.RptController   : start Cron()
2019-07-03 18:28:00.004  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:28:00.100  INFO 73664 --- [threadPoolTaskScheduler-1] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2019-07-03 18:28:00.303 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:28:00.335 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:28:00.379 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 1
2019-07-03 18:28:00.440 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : ==>  Preparing: update sys_report SET DESCRIPTION = ?, CYCLE = ?, CYCLE_TYPE = ?, BASE_TIME = ?, STARTUP_TIME = ?, EXECING = ?, ACTIVED = ?, COPERATOR = ?, CDATE = ? where CODE = ? 
2019-07-03 18:28:00.448 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : ==> Parameters: 日购电数据(String), 1(Integer), 3(String), 2016-11-09 15:54:39.0(Timestamp), 2017-12-27 03:30:00.0(Timestamp), Y(String), Y(String), admin(String), 2016-11-09 17:40:51.0(Timestamp), 00000003(String)
2019-07-03 18:28:00.481 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : <==    Updates: 1
2019-07-03 18:28:00.487  INFO 73664 --- [pool-1-thread-1] com.inhe.rpt.processor.MonthlyProcessor  : daily data start!
2019-07-03 18:28:00.490 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_meter_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:28:00.492 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20171126(String), 20171226(String)
2019-07-03 18:28:00.493 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:28:00.494 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_branch_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:28:00.494 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20171126(String), 20171226(String)
2019-07-03 18:28:00.499 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:28:00.505 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_operator_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:28:00.506 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20171126(String), 20171226(String)
2019-07-03 18:28:00.509 DEBUG 73664 --- [pool-1-thread-1] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:28:00.510 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.511 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171126(String)
2019-07-03 18:28:00.519 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.523 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.534 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-11-26(Date), 2017-11-26(Date), 2017-11-27(Date)
2019-07-03 18:28:00.538 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.544 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.546 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171126(String)
2019-07-03 18:28:00.547 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.548 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.550 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-11-26(Date), 2017-11-26(Date), 2017-11-27(Date)
2019-07-03 18:28:00.552 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.554 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.557 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171126(String)
2019-07-03 18:28:00.557 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.558 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:00.560 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-11-26(Date), 2017-11-26(Date), 2017-11-27(Date)
2019-07-03 18:28:00.561 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:00.561 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.562 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171127(String)
2019-07-03 18:28:00.563 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.565 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.568 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-11-27(Date), 2017-11-27(Date), 2017-11-28(Date)
2019-07-03 18:28:00.571 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.574 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.574 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171127(String)
2019-07-03 18:28:00.575 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.575 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.577 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-11-27(Date), 2017-11-27(Date), 2017-11-28(Date)
2019-07-03 18:28:00.578 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.580 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.581 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171127(String)
2019-07-03 18:28:00.582 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.584 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:00.597 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-11-27(Date), 2017-11-27(Date), 2017-11-28(Date)
2019-07-03 18:28:00.607 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:00.610 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.612 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171128(String)
2019-07-03 18:28:00.614 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.617 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.624 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-11-28(Date), 2017-11-28(Date), 2017-11-29(Date)
2019-07-03 18:28:00.632 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.641 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.643 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171128(String)
2019-07-03 18:28:00.646 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.647 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.651 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-11-28(Date), 2017-11-28(Date), 2017-11-29(Date)
2019-07-03 18:28:00.659 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.666 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.668 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171128(String)
2019-07-03 18:28:00.671 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.673 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:00.680 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-11-28(Date), 2017-11-28(Date), 2017-11-29(Date)
2019-07-03 18:28:00.684 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:00.690 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.692 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171129(String)
2019-07-03 18:28:00.698 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.700 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.707 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-11-29(Date), 2017-11-29(Date), 2017-11-30(Date)
2019-07-03 18:28:00.710 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.732 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.734 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171129(String)
2019-07-03 18:28:00.735 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.741 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.766 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-11-29(Date), 2017-11-29(Date), 2017-11-30(Date)
2019-07-03 18:28:00.774 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.776 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.777 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171129(String)
2019-07-03 18:28:00.779 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.783 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:00.786 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-11-29(Date), 2017-11-29(Date), 2017-11-30(Date)
2019-07-03 18:28:00.792 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:00.800 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.801 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171130(String)
2019-07-03 18:28:00.806 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.808 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.812 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-11-30(Date), 2017-11-30(Date), 2017-12-01(Date)
2019-07-03 18:28:00.819 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.825 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.829 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171130(String)
2019-07-03 18:28:00.831 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.834 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.840 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-11-30(Date), 2017-11-30(Date), 2017-12-01(Date)
2019-07-03 18:28:00.842 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.847 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.855 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171130(String)
2019-07-03 18:28:00.857 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.862 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:00.865 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-11-30(Date), 2017-11-30(Date), 2017-12-01(Date)
2019-07-03 18:28:00.873 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:00.882 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:00.883 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171201(String)
2019-07-03 18:28:00.885 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.891 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:00.901 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-01(Date), 2017-12-01(Date), 2017-12-02(Date)
2019-07-03 18:28:00.907 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:00.911 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:00.912 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171201(String)
2019-07-03 18:28:00.915 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:00.925 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:00.931 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-01(Date), 2017-12-01(Date), 2017-12-02(Date)
2019-07-03 18:28:00.935 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:00.940 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:00.942 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171201(String)
2019-07-03 18:28:00.945 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.009 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.028 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-01(Date), 2017-12-01(Date), 2017-12-02(Date)
2019-07-03 18:28:01.032 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.042 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.050 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171202(String)
2019-07-03 18:28:01.052 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.058 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.068 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-02(Date), 2017-12-02(Date), 2017-12-03(Date)
2019-07-03 18:28:01.075 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.081 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.082 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171202(String)
2019-07-03 18:28:01.085 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.091 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.097 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-02(Date), 2017-12-02(Date), 2017-12-03(Date)
2019-07-03 18:28:01.107 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.114 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.115 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171202(String)
2019-07-03 18:28:01.123 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.128 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.141 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-02(Date), 2017-12-02(Date), 2017-12-03(Date)
2019-07-03 18:28:01.146 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.147 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.148 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171203(String)
2019-07-03 18:28:01.159 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.160 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.162 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-03(Date), 2017-12-03(Date), 2017-12-04(Date)
2019-07-03 18:28:01.164 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.165 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.166 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171203(String)
2019-07-03 18:28:01.168 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.175 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.183 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-03(Date), 2017-12-03(Date), 2017-12-04(Date)
2019-07-03 18:28:01.185 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.193 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.198 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171203(String)
2019-07-03 18:28:01.200 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.201 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.203 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-03(Date), 2017-12-03(Date), 2017-12-04(Date)
2019-07-03 18:28:01.205 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.208 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.215 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171204(String)
2019-07-03 18:28:01.219 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.220 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.232 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-04(Date), 2017-12-04(Date), 2017-12-05(Date)
2019-07-03 18:28:01.248 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.251 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.256 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171204(String)
2019-07-03 18:28:01.260 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.261 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.263 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-04(Date), 2017-12-04(Date), 2017-12-05(Date)
2019-07-03 18:28:01.266 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.267 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.267 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171204(String)
2019-07-03 18:28:01.274 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.274 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.278 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-04(Date), 2017-12-04(Date), 2017-12-05(Date)
2019-07-03 18:28:01.284 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.289 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.292 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171205(String)
2019-07-03 18:28:01.298 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.300 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.302 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-05(Date), 2017-12-05(Date), 2017-12-06(Date)
2019-07-03 18:28:01.331 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 15
2019-07-03 18:28:01.333 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.335 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171205(String)
2019-07-03 18:28:01.346 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.350 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.359 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-05(Date), 2017-12-05(Date), 2017-12-06(Date)
2019-07-03 18:28:01.389 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 1
2019-07-03 18:28:01.390 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.394 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171205(String)
2019-07-03 18:28:01.401 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.402 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.407 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-05(Date), 2017-12-05(Date), 2017-12-06(Date)
2019-07-03 18:28:01.447 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 1
2019-07-03 18:28:01.448 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.449 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171206(String)
2019-07-03 18:28:01.450 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.459 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.461 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-06(Date), 2017-12-06(Date), 2017-12-07(Date)
2019-07-03 18:28:01.468 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.471 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.472 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171206(String)
2019-07-03 18:28:01.476 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.477 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.479 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-06(Date), 2017-12-06(Date), 2017-12-07(Date)
2019-07-03 18:28:01.484 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.484 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.485 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171206(String)
2019-07-03 18:28:01.497 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.498 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.503 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-06(Date), 2017-12-06(Date), 2017-12-07(Date)
2019-07-03 18:28:01.508 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.514 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.518 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171207(String)
2019-07-03 18:28:01.524 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.531 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.542 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-07(Date), 2017-12-07(Date), 2017-12-08(Date)
2019-07-03 18:28:01.551 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.552 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.555 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171207(String)
2019-07-03 18:28:01.556 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.557 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.560 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-07(Date), 2017-12-07(Date), 2017-12-08(Date)
2019-07-03 18:28:01.561 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.562 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.562 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171207(String)
2019-07-03 18:28:01.563 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.563 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.566 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-07(Date), 2017-12-07(Date), 2017-12-08(Date)
2019-07-03 18:28:01.567 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.568 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.568 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171208(String)
2019-07-03 18:28:01.569 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.569 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.573 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-08(Date), 2017-12-08(Date), 2017-12-09(Date)
2019-07-03 18:28:01.575 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.576 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.577 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171208(String)
2019-07-03 18:28:01.579 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.580 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.581 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-08(Date), 2017-12-08(Date), 2017-12-09(Date)
2019-07-03 18:28:01.582 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.582 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.583 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171208(String)
2019-07-03 18:28:01.583 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.583 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.585 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-08(Date), 2017-12-08(Date), 2017-12-09(Date)
2019-07-03 18:28:01.586 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.588 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.588 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171209(String)
2019-07-03 18:28:01.589 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.593 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.595 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-09(Date), 2017-12-09(Date), 2017-12-10(Date)
2019-07-03 18:28:01.598 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.601 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.602 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171209(String)
2019-07-03 18:28:01.604 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.605 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.617 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-09(Date), 2017-12-09(Date), 2017-12-10(Date)
2019-07-03 18:28:01.622 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.634 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.636 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171209(String)
2019-07-03 18:28:01.645 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.646 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.649 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-09(Date), 2017-12-09(Date), 2017-12-10(Date)
2019-07-03 18:28:01.652 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.652 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.653 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171210(String)
2019-07-03 18:28:01.655 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.660 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.665 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-10(Date), 2017-12-10(Date), 2017-12-11(Date)
2019-07-03 18:28:01.667 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.668 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.669 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171210(String)
2019-07-03 18:28:01.673 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.680 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.682 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-10(Date), 2017-12-10(Date), 2017-12-11(Date)
2019-07-03 18:28:01.689 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.693 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.694 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171210(String)
2019-07-03 18:28:01.694 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.696 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.698 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-10(Date), 2017-12-10(Date), 2017-12-11(Date)
2019-07-03 18:28:01.703 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.705 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.707 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171211(String)
2019-07-03 18:28:01.713 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.714 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.716 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-11(Date), 2017-12-11(Date), 2017-12-12(Date)
2019-07-03 18:28:01.718 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.725 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.728 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171211(String)
2019-07-03 18:28:01.729 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.733 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.736 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-11(Date), 2017-12-11(Date), 2017-12-12(Date)
2019-07-03 18:28:01.740 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.746 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.747 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171211(String)
2019-07-03 18:28:01.749 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.750 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.759 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-11(Date), 2017-12-11(Date), 2017-12-12(Date)
2019-07-03 18:28:01.766 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.767 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.768 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171212(String)
2019-07-03 18:28:01.770 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.772 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.780 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-12(Date), 2017-12-12(Date), 2017-12-13(Date)
2019-07-03 18:28:01.784 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.788 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.792 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171212(String)
2019-07-03 18:28:01.792 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.794 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.796 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-12(Date), 2017-12-12(Date), 2017-12-13(Date)
2019-07-03 18:28:01.801 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.802 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.805 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171212(String)
2019-07-03 18:28:01.813 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.814 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.816 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-12(Date), 2017-12-12(Date), 2017-12-13(Date)
2019-07-03 18:28:01.818 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.819 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.821 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171213(String)
2019-07-03 18:28:01.825 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.825 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.827 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-13(Date), 2017-12-13(Date), 2017-12-14(Date)
2019-07-03 18:28:01.830 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.838 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.840 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171213(String)
2019-07-03 18:28:01.844 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.851 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.856 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-13(Date), 2017-12-13(Date), 2017-12-14(Date)
2019-07-03 18:28:01.863 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.865 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.866 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171213(String)
2019-07-03 18:28:01.868 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.871 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.874 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-13(Date), 2017-12-13(Date), 2017-12-14(Date)
2019-07-03 18:28:01.876 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.880 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.881 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171214(String)
2019-07-03 18:28:01.884 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.888 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.890 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-14(Date), 2017-12-14(Date), 2017-12-15(Date)
2019-07-03 18:28:01.893 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.895 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:01.899 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171214(String)
2019-07-03 18:28:01.901 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.906 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:01.913 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-14(Date), 2017-12-14(Date), 2017-12-15(Date)
2019-07-03 18:28:01.920 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:01.923 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:01.931 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171214(String)
2019-07-03 18:28:01.933 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.935 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:01.942 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-14(Date), 2017-12-14(Date), 2017-12-15(Date)
2019-07-03 18:28:01.946 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:01.956 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:01.960 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171215(String)
2019-07-03 18:28:01.965 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:01.973 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:01.982 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-15(Date), 2017-12-15(Date), 2017-12-16(Date)
2019-07-03 18:28:01.991 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:01.997 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.006 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171215(String)
2019-07-03 18:28:02.010 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.012 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.016 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-15(Date), 2017-12-15(Date), 2017-12-16(Date)
2019-07-03 18:28:02.024 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.025 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.027 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171215(String)
2019-07-03 18:28:02.027 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.028 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.029 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-15(Date), 2017-12-15(Date), 2017-12-16(Date)
2019-07-03 18:28:02.030 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.039 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.040 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171216(String)
2019-07-03 18:28:02.043 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.045 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.056 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-16(Date), 2017-12-16(Date), 2017-12-17(Date)
2019-07-03 18:28:02.058 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.064 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.065 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171216(String)
2019-07-03 18:28:02.068 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.074 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.076 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-16(Date), 2017-12-16(Date), 2017-12-17(Date)
2019-07-03 18:28:02.085 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.086 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.090 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171216(String)
2019-07-03 18:28:02.092 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.094 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.101 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-16(Date), 2017-12-16(Date), 2017-12-17(Date)
2019-07-03 18:28:02.111 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.113 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.113 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171217(String)
2019-07-03 18:28:02.115 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.116 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.118 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-17(Date), 2017-12-17(Date), 2017-12-18(Date)
2019-07-03 18:28:02.122 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.123 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.169 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171217(String)
2019-07-03 18:28:02.170 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.171 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.173 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-17(Date), 2017-12-17(Date), 2017-12-18(Date)
2019-07-03 18:28:02.184 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.185 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.186 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171217(String)
2019-07-03 18:28:02.187 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.189 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.192 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-17(Date), 2017-12-17(Date), 2017-12-18(Date)
2019-07-03 18:28:02.198 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.199 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.200 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171218(String)
2019-07-03 18:28:02.201 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.202 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.205 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-18(Date), 2017-12-18(Date), 2017-12-19(Date)
2019-07-03 18:28:02.206 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.210 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.214 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171218(String)
2019-07-03 18:28:02.215 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.217 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.221 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-18(Date), 2017-12-18(Date), 2017-12-19(Date)
2019-07-03 18:28:02.226 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.226 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.228 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171218(String)
2019-07-03 18:28:02.229 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.229 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.230 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-18(Date), 2017-12-18(Date), 2017-12-19(Date)
2019-07-03 18:28:02.232 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.232 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.233 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171219(String)
2019-07-03 18:28:02.233 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.233 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.235 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-19(Date), 2017-12-19(Date), 2017-12-20(Date)
2019-07-03 18:28:02.236 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.238 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.238 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171219(String)
2019-07-03 18:28:02.239 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.240 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.242 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-19(Date), 2017-12-19(Date), 2017-12-20(Date)
2019-07-03 18:28:02.243 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.244 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.244 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171219(String)
2019-07-03 18:28:02.245 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.245 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.246 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-19(Date), 2017-12-19(Date), 2017-12-20(Date)
2019-07-03 18:28:02.247 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.249 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.251 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171220(String)
2019-07-03 18:28:02.251 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.252 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.255 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-20(Date), 2017-12-20(Date), 2017-12-21(Date)
2019-07-03 18:28:02.257 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.258 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.258 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171220(String)
2019-07-03 18:28:02.259 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.260 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.261 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-20(Date), 2017-12-20(Date), 2017-12-21(Date)
2019-07-03 18:28:02.261 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.262 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.262 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171220(String)
2019-07-03 18:28:02.263 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.263 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.264 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-20(Date), 2017-12-20(Date), 2017-12-21(Date)
2019-07-03 18:28:02.265 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.265 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.265 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171221(String)
2019-07-03 18:28:02.266 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.266 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.272 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-21(Date), 2017-12-21(Date), 2017-12-22(Date)
2019-07-03 18:28:02.277 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.278 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.279 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171221(String)
2019-07-03 18:28:02.282 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.285 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.293 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-21(Date), 2017-12-21(Date), 2017-12-22(Date)
2019-07-03 18:28:02.300 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.301 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.302 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171221(String)
2019-07-03 18:28:02.302 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.306 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.309 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-21(Date), 2017-12-21(Date), 2017-12-22(Date)
2019-07-03 18:28:02.310 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.311 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.317 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171222(String)
2019-07-03 18:28:02.318 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.318 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.321 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-22(Date), 2017-12-22(Date), 2017-12-23(Date)
2019-07-03 18:28:02.323 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.326 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.327 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171222(String)
2019-07-03 18:28:02.329 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.333 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.335 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-22(Date), 2017-12-22(Date), 2017-12-23(Date)
2019-07-03 18:28:02.341 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.346 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.347 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171222(String)
2019-07-03 18:28:02.348 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.349 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.351 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-22(Date), 2017-12-22(Date), 2017-12-23(Date)
2019-07-03 18:28:02.362 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.363 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.365 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171223(String)
2019-07-03 18:28:02.366 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.371 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.377 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-23(Date), 2017-12-23(Date), 2017-12-24(Date)
2019-07-03 18:28:02.383 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.384 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.385 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171223(String)
2019-07-03 18:28:02.386 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.387 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.389 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-23(Date), 2017-12-23(Date), 2017-12-24(Date)
2019-07-03 18:28:02.400 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.401 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.403 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171223(String)
2019-07-03 18:28:02.406 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.409 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.414 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-23(Date), 2017-12-23(Date), 2017-12-24(Date)
2019-07-03 18:28:02.415 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.416 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.417 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171224(String)
2019-07-03 18:28:02.417 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.417 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.419 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-24(Date), 2017-12-24(Date), 2017-12-25(Date)
2019-07-03 18:28:02.422 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.422 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.423 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171224(String)
2019-07-03 18:28:02.423 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.424 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.427 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-24(Date), 2017-12-24(Date), 2017-12-25(Date)
2019-07-03 18:28:02.428 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.428 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.429 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171224(String)
2019-07-03 18:28:02.429 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.429 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.430 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-24(Date), 2017-12-24(Date), 2017-12-25(Date)
2019-07-03 18:28:02.431 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.432 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.433 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171225(String)
2019-07-03 18:28:02.433 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.434 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.435 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-25(Date), 2017-12-25(Date), 2017-12-26(Date)
2019-07-03 18:28:02.438 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.438 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.439 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171225(String)
2019-07-03 18:28:02.439 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.439 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.440 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-25(Date), 2017-12-25(Date), 2017-12-26(Date)
2019-07-03 18:28:02.441 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.442 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.446 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171225(String)
2019-07-03 18:28:02.447 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.449 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.450 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-25(Date), 2017-12-25(Date), 2017-12-26(Date)
2019-07-03 18:28:02.453 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.456 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:28:02.459 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171226(String)
2019-07-03 18:28:02.460 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.460 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:28:02.464 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-12-26(Date), 2017-12-26(Date), 2017-12-27(Date)
2019-07-03 18:28:02.473 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:28:02.475 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:28:02.476 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171226(String)
2019-07-03 18:28:02.478 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.482 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:28:02.484 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-12-26(Date), 2017-12-26(Date), 2017-12-27(Date)
2019-07-03 18:28:02.491 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:28:02.495 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:28:02.496 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20171226(String)
2019-07-03 18:28:02.497 DEBUG 73664 --- [pool-1-thread-1] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:28:02.498 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:28:02.500 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-12-26(Date), 2017-12-26(Date), 2017-12-27(Date)
2019-07-03 18:28:02.510 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:28:02.511  INFO 73664 --- [pool-1-thread-1] com.inhe.rpt.processor.MonthlyProcessor  : daily data end!
2019-07-03 18:28:02.518 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : ==>  Preparing: update sys_report SET DESCRIPTION = ?, CYCLE = ?, CYCLE_TYPE = ?, BASE_TIME = ?, STARTUP_TIME = ?, EXECING = ?, ACTIVED = ?, COPERATOR = ?, CDATE = ? where CODE = ? 
2019-07-03 18:28:02.521 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : ==> Parameters: 日购电数据(String), 1(Integer), 3(String), 2016-11-09 15:54:39.0(Timestamp), 2019-07-04 03:30:00.0(Timestamp), N(String), Y(String), admin(String), 2016-11-09 17:40:51.0(Timestamp), 00000003(String)
2019-07-03 18:28:02.597 DEBUG 73664 --- [pool-1-thread-1] c.i.r.m.S.updateByPrimaryKeySelective    : <==    Updates: 1
2019-07-03 18:28:02.599  INFO 73664 --- [pool-1-thread-1] com.inhe.rpt.task.RptTask                : task finsih
2019-07-03 18:30:00.003  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:30:00.026 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:30:00.027 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:30:00.030 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:32:00.883  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:32:00.886 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:32:00.897 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:32:00.900 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 1
2019-07-03 18:32:00.904 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : ==>  Preparing: update sys_report SET DESCRIPTION = ?, CYCLE = ?, CYCLE_TYPE = ?, BASE_TIME = ?, STARTUP_TIME = ?, EXECING = ?, ACTIVED = ?, COPERATOR = ?, CDATE = ? where CODE = ? 
2019-07-03 18:32:00.905 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : ==> Parameters: 日购电数据(String), 1(Integer), 3(String), 2016-11-09 15:54:39.0(Timestamp), 2017-01-27 03:30:00.0(Timestamp), Y(String), Y(String), admin(String), 2016-11-09 17:40:51.0(Timestamp), 00000003(String)
2019-07-03 18:32:00.938 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : <==    Updates: 1
2019-07-03 18:32:00.938  INFO 73664 --- [pool-1-thread-2] com.inhe.rpt.processor.MonthlyProcessor  : daily data start!
2019-07-03 18:32:00.939 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_meter_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:32:00.940 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20161227(String), 20170126(String)
2019-07-03 18:32:00.941 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:32:00.944 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_branch_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:32:00.944 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20161227(String), 20170126(String)
2019-07-03 18:32:00.945 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:32:00.945 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==>  Preparing: select DATA_PERIOD from rpt_operator_day where DATA_PERIOD>=? and DATA_PERIOD<? group by DATA_PERIOD 
2019-07-03 18:32:00.946 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : ==> Parameters: 20161227(String), 20170126(String)
2019-07-03 18:32:00.947 DEBUG 73664 --- [pool-1-thread-2] c.i.rpt.mapper.RptDayMapper.getLastDay   : <==      Total: 0
2019-07-03 18:32:00.947 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:00.948 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161227(String)
2019-07-03 18:32:00.948 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:00.949 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:00.950 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2016-12-27(Date), 2016-12-27(Date), 2016-12-28(Date)
2019-07-03 18:32:00.988 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 178
2019-07-03 18:32:00.988 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:00.989 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161227(String)
2019-07-03 18:32:00.990 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:00.991 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:00.993 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2016-12-27(Date), 2016-12-27(Date), 2016-12-28(Date)
2019-07-03 18:32:01.038 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 2
2019-07-03 18:32:01.038 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.039 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161227(String)
2019-07-03 18:32:01.039 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.040 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.041 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2016-12-27(Date), 2016-12-27(Date), 2016-12-28(Date)
2019-07-03 18:32:01.080 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 2
2019-07-03 18:32:01.080 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.080 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161228(String)
2019-07-03 18:32:01.081 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.082 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.083 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2016-12-28(Date), 2016-12-28(Date), 2016-12-29(Date)
2019-07-03 18:32:01.130 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 124
2019-07-03 18:32:01.130 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.131 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161228(String)
2019-07-03 18:32:01.132 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.132 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.140 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2016-12-28(Date), 2016-12-28(Date), 2016-12-29(Date)
2019-07-03 18:32:01.189 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:01.190 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.190 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161228(String)
2019-07-03 18:32:01.191 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.192 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.193 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2016-12-28(Date), 2016-12-28(Date), 2016-12-29(Date)
2019-07-03 18:32:01.232 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:01.237 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.238 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161229(String)
2019-07-03 18:32:01.239 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.240 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.242 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2016-12-29(Date), 2016-12-29(Date), 2016-12-30(Date)
2019-07-03 18:32:01.289 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 129
2019-07-03 18:32:01.289 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.290 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161229(String)
2019-07-03 18:32:01.291 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.291 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.294 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2016-12-29(Date), 2016-12-29(Date), 2016-12-30(Date)
2019-07-03 18:32:01.347 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:01.347 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.348 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161229(String)
2019-07-03 18:32:01.348 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.349 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.350 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2016-12-29(Date), 2016-12-29(Date), 2016-12-30(Date)
2019-07-03 18:32:01.389 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:01.390 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.390 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161230(String)
2019-07-03 18:32:01.391 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.392 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.393 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2016-12-30(Date), 2016-12-30(Date), 2016-12-31(Date)
2019-07-03 18:32:01.439 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 106
2019-07-03 18:32:01.439 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.440 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161230(String)
2019-07-03 18:32:01.440 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.441 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.442 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2016-12-30(Date), 2016-12-30(Date), 2016-12-31(Date)
2019-07-03 18:32:01.492 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 2
2019-07-03 18:32:01.492 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.493 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161230(String)
2019-07-03 18:32:01.493 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.494 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.495 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2016-12-30(Date), 2016-12-30(Date), 2016-12-31(Date)
2019-07-03 18:32:01.531 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 2
2019-07-03 18:32:01.531 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.531 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161231(String)
2019-07-03 18:32:01.533 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.533 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.536 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2016-12-31(Date), 2016-12-31(Date), 2017-01-01(Date)
2019-07-03 18:32:01.573 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 103
2019-07-03 18:32:01.574 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.576 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161231(String)
2019-07-03 18:32:01.577 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.577 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.579 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2016-12-31(Date), 2016-12-31(Date), 2017-01-01(Date)
2019-07-03 18:32:01.615 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:01.617 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.617 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20161231(String)
2019-07-03 18:32:01.618 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.618 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.619 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2016-12-31(Date), 2016-12-31(Date), 2017-01-01(Date)
2019-07-03 18:32:01.656 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:01.657 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.657 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170101(String)
2019-07-03 18:32:01.660 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.660 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.661 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-01(Date), 2017-01-01(Date), 2017-01-02(Date)
2019-07-03 18:32:01.662 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:32:01.663 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.663 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170101(String)
2019-07-03 18:32:01.664 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.664 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.665 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-01(Date), 2017-01-01(Date), 2017-01-02(Date)
2019-07-03 18:32:01.666 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:32:01.667 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.667 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170101(String)
2019-07-03 18:32:01.668 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.668 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.669 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-01(Date), 2017-01-01(Date), 2017-01-02(Date)
2019-07-03 18:32:01.670 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:32:01.670 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.671 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170102(String)
2019-07-03 18:32:01.672 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.673 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.674 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-02(Date), 2017-01-02(Date), 2017-01-03(Date)
2019-07-03 18:32:01.675 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:32:01.675 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.676 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170102(String)
2019-07-03 18:32:01.676 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.677 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.678 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-02(Date), 2017-01-02(Date), 2017-01-03(Date)
2019-07-03 18:32:01.679 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:32:01.679 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.679 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170102(String)
2019-07-03 18:32:01.681 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.681 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.682 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-02(Date), 2017-01-02(Date), 2017-01-03(Date)
2019-07-03 18:32:01.683 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:32:01.684 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.684 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170103(String)
2019-07-03 18:32:01.685 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.686 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.687 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-03(Date), 2017-01-03(Date), 2017-01-04(Date)
2019-07-03 18:32:01.745 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 195
2019-07-03 18:32:01.745 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.746 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170103(String)
2019-07-03 18:32:01.746 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.747 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.748 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-03(Date), 2017-01-03(Date), 2017-01-04(Date)
2019-07-03 18:32:01.790 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:01.790 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.791 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170103(String)
2019-07-03 18:32:01.792 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.793 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.794 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-03(Date), 2017-01-03(Date), 2017-01-04(Date)
2019-07-03 18:32:01.831 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:01.832 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.833 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170104(String)
2019-07-03 18:32:01.842 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.842 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.844 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-04(Date), 2017-01-04(Date), 2017-01-05(Date)
2019-07-03 18:32:01.888 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 146
2019-07-03 18:32:01.890 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:01.899 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170104(String)
2019-07-03 18:32:01.900 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.901 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:01.902 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-04(Date), 2017-01-04(Date), 2017-01-05(Date)
2019-07-03 18:32:01.940 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:01.941 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:01.941 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170104(String)
2019-07-03 18:32:01.942 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.942 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:01.944 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-04(Date), 2017-01-04(Date), 2017-01-05(Date)
2019-07-03 18:32:01.990 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:01.993 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:01.993 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170105(String)
2019-07-03 18:32:01.997 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:01.997 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:01.998 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-05(Date), 2017-01-05(Date), 2017-01-06(Date)
2019-07-03 18:32:02.041 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 119
2019-07-03 18:32:02.041 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.041 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170105(String)
2019-07-03 18:32:02.042 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.042 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.043 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-05(Date), 2017-01-05(Date), 2017-01-06(Date)
2019-07-03 18:32:02.099 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:02.100 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.102 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170105(String)
2019-07-03 18:32:02.103 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.103 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.106 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-05(Date), 2017-01-05(Date), 2017-01-06(Date)
2019-07-03 18:32:02.267 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:02.269 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.269 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170106(String)
2019-07-03 18:32:02.274 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.275 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:02.283 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-06(Date), 2017-01-06(Date), 2017-01-07(Date)
2019-07-03 18:32:02.364 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 106
2019-07-03 18:32:02.365 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.365 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170106(String)
2019-07-03 18:32:02.366 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.366 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.368 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-06(Date), 2017-01-06(Date), 2017-01-07(Date)
2019-07-03 18:32:02.407 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:02.408 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.408 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170106(String)
2019-07-03 18:32:02.410 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.411 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.412 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-06(Date), 2017-01-06(Date), 2017-01-07(Date)
2019-07-03 18:32:02.455 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:02.455 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.458 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170107(String)
2019-07-03 18:32:02.461 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.462 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:02.463 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-07(Date), 2017-01-07(Date), 2017-01-08(Date)
2019-07-03 18:32:02.534 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 86
2019-07-03 18:32:02.535 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.536 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170107(String)
2019-07-03 18:32:02.538 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.539 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.541 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-07(Date), 2017-01-07(Date), 2017-01-08(Date)
2019-07-03 18:32:02.588 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:02.589 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.590 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170107(String)
2019-07-03 18:32:02.591 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.591 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.593 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-07(Date), 2017-01-07(Date), 2017-01-08(Date)
2019-07-03 18:32:02.642 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:02.642 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.643 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170108(String)
2019-07-03 18:32:02.645 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.646 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:02.647 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-08(Date), 2017-01-08(Date), 2017-01-09(Date)
2019-07-03 18:32:02.649 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:32:02.649 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.650 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170108(String)
2019-07-03 18:32:02.650 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.651 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.652 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-08(Date), 2017-01-08(Date), 2017-01-09(Date)
2019-07-03 18:32:02.653 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:32:02.654 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.654 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170108(String)
2019-07-03 18:32:02.655 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.655 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.657 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-08(Date), 2017-01-08(Date), 2017-01-09(Date)
2019-07-03 18:32:02.658 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:32:02.658 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.658 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170109(String)
2019-07-03 18:32:02.661 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.661 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:02.662 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-09(Date), 2017-01-09(Date), 2017-01-10(Date)
2019-07-03 18:32:02.713 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 152
2019-07-03 18:32:02.714 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.715 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170109(String)
2019-07-03 18:32:02.716 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.716 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.718 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-09(Date), 2017-01-09(Date), 2017-01-10(Date)
2019-07-03 18:32:02.767 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:02.768 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.768 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170109(String)
2019-07-03 18:32:02.769 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.769 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.771 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-09(Date), 2017-01-09(Date), 2017-01-10(Date)
2019-07-03 18:32:02.813 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:02.814 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.814 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170110(String)
2019-07-03 18:32:02.817 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.817 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:02.818 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-10(Date), 2017-01-10(Date), 2017-01-11(Date)
2019-07-03 18:32:02.859 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 135
2019-07-03 18:32:02.860 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:02.861 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170110(String)
2019-07-03 18:32:02.862 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.863 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:02.865 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-10(Date), 2017-01-10(Date), 2017-01-11(Date)
2019-07-03 18:32:02.930 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:02.931 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:02.931 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170110(String)
2019-07-03 18:32:02.932 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.933 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:02.935 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-10(Date), 2017-01-10(Date), 2017-01-11(Date)
2019-07-03 18:32:02.992 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:02.993 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:02.994 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170111(String)
2019-07-03 18:32:02.999 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:02.999 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:03.002 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-11(Date), 2017-01-11(Date), 2017-01-12(Date)
2019-07-03 18:32:03.055 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 101
2019-07-03 18:32:03.056 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:03.056 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170111(String)
2019-07-03 18:32:03.057 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.058 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:03.060 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-11(Date), 2017-01-11(Date), 2017-01-12(Date)
2019-07-03 18:32:03.101 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:03.101 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:03.102 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170111(String)
2019-07-03 18:32:03.103 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.103 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:03.104 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-11(Date), 2017-01-11(Date), 2017-01-12(Date)
2019-07-03 18:32:03.140 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:03.141 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:03.142 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170112(String)
2019-07-03 18:32:03.146 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.146 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:03.149 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-12(Date), 2017-01-12(Date), 2017-01-13(Date)
2019-07-03 18:32:03.193 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 124
2019-07-03 18:32:03.194 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:03.194 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170112(String)
2019-07-03 18:32:03.195 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.195 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:03.196 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-12(Date), 2017-01-12(Date), 2017-01-13(Date)
2019-07-03 18:32:03.238 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 2
2019-07-03 18:32:03.239 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:03.240 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170112(String)
2019-07-03 18:32:03.240 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.241 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:03.242 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-12(Date), 2017-01-12(Date), 2017-01-13(Date)
2019-07-03 18:32:03.285 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 2
2019-07-03 18:32:03.285 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:03.286 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170113(String)
2019-07-03 18:32:03.289 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.289 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:03.290 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-13(Date), 2017-01-13(Date), 2017-01-14(Date)
2019-07-03 18:32:03.339 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 117
2019-07-03 18:32:03.339 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:03.340 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170113(String)
2019-07-03 18:32:03.340 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.340 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:03.341 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-13(Date), 2017-01-13(Date), 2017-01-14(Date)
2019-07-03 18:32:03.393 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:03.394 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:03.394 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170113(String)
2019-07-03 18:32:03.395 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.396 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:03.397 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-13(Date), 2017-01-13(Date), 2017-01-14(Date)
2019-07-03 18:32:03.430 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:03.430 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:03.431 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170114(String)
2019-07-03 18:32:03.433 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:03.434 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:03.435 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-14(Date), 2017-01-14(Date), 2017-01-15(Date)
2019-07-03 18:32:03.518 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 85
2019-07-03 18:32:06.006 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:06.011 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170114(String)
2019-07-03 18:32:06.011 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.012 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:06.013 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-14(Date), 2017-01-14(Date), 2017-01-15(Date)
2019-07-03 18:32:06.048 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:06.048 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:06.048 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170114(String)
2019-07-03 18:32:06.049 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.049 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:06.051 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-14(Date), 2017-01-14(Date), 2017-01-15(Date)
2019-07-03 18:32:06.086 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:06.088 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:06.089 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170115(String)
2019-07-03 18:32:06.092 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.095 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:06.097 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-15(Date), 2017-01-15(Date), 2017-01-16(Date)
2019-07-03 18:32:06.100 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:32:06.103 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:06.104 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170115(String)
2019-07-03 18:32:06.105 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.106 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:06.108 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-15(Date), 2017-01-15(Date), 2017-01-16(Date)
2019-07-03 18:32:06.116 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:32:06.117 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:06.119 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170115(String)
2019-07-03 18:32:06.121 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.122 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:06.131 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-15(Date), 2017-01-15(Date), 2017-01-16(Date)
2019-07-03 18:32:06.154 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:32:06.158 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:06.165 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170116(String)
2019-07-03 18:32:06.169 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.172 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:06.176 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-16(Date), 2017-01-16(Date), 2017-01-17(Date)
2019-07-03 18:32:06.245 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 157
2019-07-03 18:32:06.248 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:06.250 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170116(String)
2019-07-03 18:32:06.256 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.258 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:06.263 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-16(Date), 2017-01-16(Date), 2017-01-17(Date)
2019-07-03 18:32:06.331 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:06.333 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:06.334 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170116(String)
2019-07-03 18:32:06.335 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.340 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:06.343 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-16(Date), 2017-01-16(Date), 2017-01-17(Date)
2019-07-03 18:32:06.403 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:06.405 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:06.407 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170117(String)
2019-07-03 18:32:06.418 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.421 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:06.424 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-17(Date), 2017-01-17(Date), 2017-01-18(Date)
2019-07-03 18:32:06.495 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 117
2019-07-03 18:32:06.497 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:06.498 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170117(String)
2019-07-03 18:32:06.505 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.508 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:06.512 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-17(Date), 2017-01-17(Date), 2017-01-18(Date)
2019-07-03 18:32:06.798 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:06.799 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:06.800 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170117(String)
2019-07-03 18:32:06.806 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.806 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:06.809 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-17(Date), 2017-01-17(Date), 2017-01-18(Date)
2019-07-03 18:32:06.899 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:06.902 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:06.905 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170118(String)
2019-07-03 18:32:06.919 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.922 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:06.930 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-18(Date), 2017-01-18(Date), 2017-01-19(Date)
2019-07-03 18:32:06.971 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 110
2019-07-03 18:32:06.971 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:06.973 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170118(String)
2019-07-03 18:32:06.978 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:06.979 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:06.982 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-18(Date), 2017-01-18(Date), 2017-01-19(Date)
2019-07-03 18:32:07.023 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 2
2019-07-03 18:32:07.025 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.026 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170118(String)
2019-07-03 18:32:07.031 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.032 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.034 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-18(Date), 2017-01-18(Date), 2017-01-19(Date)
2019-07-03 18:32:07.071 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 2
2019-07-03 18:32:07.072 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:07.074 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170119(String)
2019-07-03 18:32:07.082 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.083 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:07.085 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-19(Date), 2017-01-19(Date), 2017-01-20(Date)
2019-07-03 18:32:07.124 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 111
2019-07-03 18:32:07.124 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:07.126 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170119(String)
2019-07-03 18:32:07.135 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.139 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:07.142 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-19(Date), 2017-01-19(Date), 2017-01-20(Date)
2019-07-03 18:32:07.171 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:07.174 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.177 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170119(String)
2019-07-03 18:32:07.179 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.183 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.186 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-19(Date), 2017-01-19(Date), 2017-01-20(Date)
2019-07-03 18:32:07.240 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:07.241 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:07.244 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170120(String)
2019-07-03 18:32:07.252 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.255 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:07.262 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-20(Date), 2017-01-20(Date), 2017-01-21(Date)
2019-07-03 18:32:07.330 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 131
2019-07-03 18:32:07.332 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:07.336 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170120(String)
2019-07-03 18:32:07.338 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.341 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:07.344 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-20(Date), 2017-01-20(Date), 2017-01-21(Date)
2019-07-03 18:32:07.398 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:07.399 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.401 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170120(String)
2019-07-03 18:32:07.407 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.407 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.410 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-20(Date), 2017-01-20(Date), 2017-01-21(Date)
2019-07-03 18:32:07.455 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:07.456 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:07.458 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170121(String)
2019-07-03 18:32:07.465 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.466 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:07.469 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-21(Date), 2017-01-21(Date), 2017-01-22(Date)
2019-07-03 18:32:07.515 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 63
2019-07-03 18:32:07.517 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:07.519 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170121(String)
2019-07-03 18:32:07.523 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.526 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:07.529 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-21(Date), 2017-01-21(Date), 2017-01-22(Date)
2019-07-03 18:32:07.564 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:07.567 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.570 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170121(String)
2019-07-03 18:32:07.574 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.579 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.585 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-21(Date), 2017-01-21(Date), 2017-01-22(Date)
2019-07-03 18:32:07.716 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:07.717 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:07.720 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170122(String)
2019-07-03 18:32:07.733 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.740 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:07.743 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-22(Date), 2017-01-22(Date), 2017-01-23(Date)
2019-07-03 18:32:07.756 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 0
2019-07-03 18:32:07.757 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:07.760 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170122(String)
2019-07-03 18:32:07.762 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.763 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:07.768 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-22(Date), 2017-01-22(Date), 2017-01-23(Date)
2019-07-03 18:32:07.771 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 0
2019-07-03 18:32:07.776 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.777 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170122(String)
2019-07-03 18:32:07.778 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.779 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.781 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-22(Date), 2017-01-22(Date), 2017-01-23(Date)
2019-07-03 18:32:07.785 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 0
2019-07-03 18:32:07.788 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:07.792 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170123(String)
2019-07-03 18:32:07.797 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.797 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:07.799 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-23(Date), 2017-01-23(Date), 2017-01-24(Date)
2019-07-03 18:32:07.873 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 155
2019-07-03 18:32:07.875 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:07.876 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170123(String)
2019-07-03 18:32:07.878 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.883 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:07.886 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-23(Date), 2017-01-23(Date), 2017-01-24(Date)
2019-07-03 18:32:07.947 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:07.948 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:07.950 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170123(String)
2019-07-03 18:32:07.952 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:07.957 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:07.959 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-23(Date), 2017-01-23(Date), 2017-01-24(Date)
2019-07-03 18:32:08.015 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:08.016 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:08.019 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170124(String)
2019-07-03 18:32:08.031 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.033 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:08.037 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-24(Date), 2017-01-24(Date), 2017-01-25(Date)
2019-07-03 18:32:08.089 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 124
2019-07-03 18:32:08.091 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:08.093 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170124(String)
2019-07-03 18:32:08.095 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.099 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:08.102 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-24(Date), 2017-01-24(Date), 2017-01-25(Date)
2019-07-03 18:32:08.157 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:08.158 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:08.160 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170124(String)
2019-07-03 18:32:08.165 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.166 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:08.169 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-24(Date), 2017-01-24(Date), 2017-01-25(Date)
2019-07-03 18:32:08.205 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:08.206 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:08.207 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170125(String)
2019-07-03 18:32:08.212 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.213 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:08.214 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-25(Date), 2017-01-25(Date), 2017-01-26(Date)
2019-07-03 18:32:08.257 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 132
2019-07-03 18:32:08.258 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:08.261 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170125(String)
2019-07-03 18:32:08.263 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.267 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:08.272 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-25(Date), 2017-01-25(Date), 2017-01-26(Date)
2019-07-03 18:32:08.323 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 3
2019-07-03 18:32:08.325 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:08.327 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170125(String)
2019-07-03 18:32:08.328 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.332 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:08.338 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-25(Date), 2017-01-25(Date), 2017-01-26(Date)
2019-07-03 18:32:08.373 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 3
2019-07-03 18:32:08.374 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_meter_day where DATA_PERIOD=? 
2019-07-03 18:32:08.375 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170126(String)
2019-07-03 18:32:08.383 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.384 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==>  Preparing: INSERT INTO rpt_meter_day(DEVICE_CODE,DATA_PERIOD,BRANCH_CODE,REF_CODE,FULL_NAME,METER_NUM ,TARIFF_CODE,AREA_CODE,NET_KWH,NET_AMT,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1 ,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.RegCode AS DEVICE_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, A.RefCode AS REF_CODE, A.FullName AS FULL_NAME, A.MeterNum AS METER_NUM, A.TariffCode AS TARIFF_CODE, A.AreaCode AS AREA_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, COUNT(A.Code) AS BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.RegCode 
2019-07-03 18:32:08.386 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : ==> Parameters: 2017-01-26(Date), 2017-01-26(Date), 2017-01-27(Date)
2019-07-03 18:32:08.432 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptMeterDay   : <==    Updates: 126
2019-07-03 18:32:08.432 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_branch_day where DATA_PERIOD=? 
2019-07-03 18:32:08.434 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170126(String)
2019-07-03 18:32:08.435 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.441 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==>  Preparing: INSERT INTO rpt_branch_day(BRANCH_CODE,DATA_PERIOD,BRANCH_NAME,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.BranchCode AS BRANCH_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, F.Name AS BRANCH_NAME, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' left JOIN bz_branch F ON A.BranchCode = F.Code WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.BranchCode 
2019-07-03 18:32:08.442 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : ==> Parameters: 2017-01-26(Date), 2017-01-26(Date), 2017-01-27(Date)
2019-07-03 18:32:08.481 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.RptDayMapper.insertRptBranchDay  : <==    Updates: 2
2019-07-03 18:32:08.483 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==>  Preparing: delete from rpt_operator_day where DATA_PERIOD=? 
2019-07-03 18:32:08.484 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : ==> Parameters: 20170126(String)
2019-07-03 18:32:08.485 DEBUG 73664 --- [pool-1-thread-2] c.i.r.mapper.RptDayMapper.deleteDayData  : <==    Updates: 0
2019-07-03 18:32:08.489 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==>  Preparing: INSERT INTO rpt_Operator_day(OPERATOR_CODE,DATA_PERIOD,BRANCH_CODE,NET_KWH,NET_AMT ,STAMP_TAX,TVA_AMT,KWH_AMT,FEE_AMT,FEE_TVA,FEE1,FEE1_TVA,FEE2,FEE2_TVA,FEE3,FEE3_TVA ,FEE4,FEE4_TVA,ARREAR_AMT,ARREAR_TVA,BUY_TIMES) SELECT A.COperator AS OPERATOR_CODE, DATE_FORMAT(?,'%Y%m%d') AS DATA_PERIOD, A.BranchCode AS BRANCH_CODE, SUM(A.VendQty) AS NET_KWH, SUM(A.NetAMT) AS NET_AMT, SUM(A.StampTax) AS STAMP_TAX, SUM(A.VAT) AS TVA_AMT, SUM(A.VendVAT) AS KWH_AMT, SUM(A.FeeAMT) AS FEE_AMT, SUM(A.FeeVAT) AS FEE_TVA, SUM(B.Fee) AS FEE1, SUM(b.VAT) AS FEE1_VAT, SUM(C.Fee) AS FEE2, SUM(C.VAT) AS FEE2_VAT, SUM(D.Fee) AS FEE3, SUM(D.VAT) AS FEE3_VAT, SUM(E.Fee) AS FEE4, SUM(E.VAT) AS FEE4_VAT, SUM(A.ArrearAMT-A.ArrearVAT) ARREAR_AMT, SUM(A.ArrearVAT) ARREAR_TVA, count(A.Code) as BUY_TIMES FROM bz_meter_vend A LEFT JOIN bz_meter_fee B ON B.FeeType='03' AND B.RefCode=A.`Code` AND B.FeeCode='001' LEFT JOIN bz_meter_fee C ON C.FeeType='03' AND C.RefCode=A.`Code` AND C.FeeCode='002' LEFT JOIN bz_meter_fee D ON D.FeeType='03' AND D.RefCode=A.`Code` AND D.FeeCode='003' LEFT JOIN bz_meter_fee E ON E.FeeType='03' AND E.RefCode=A.`Code` AND E.FeeCode='004' WHERE A.VendDate >= ? AND A.VendDate < ? GROUP BY A.COperator 
2019-07-03 18:32:08.491 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : ==> Parameters: 2017-01-26(Date), 2017-01-26(Date), 2017-01-27(Date)
2019-07-03 18:32:08.532 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.R.insertRptOperatorDay           : <==    Updates: 2
2019-07-03 18:32:08.535  INFO 73664 --- [pool-1-thread-2] com.inhe.rpt.processor.MonthlyProcessor  : daily data end!
2019-07-03 18:32:08.545 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : ==>  Preparing: update sys_report SET DESCRIPTION = ?, CYCLE = ?, CYCLE_TYPE = ?, BASE_TIME = ?, STARTUP_TIME = ?, EXECING = ?, ACTIVED = ?, COPERATOR = ?, CDATE = ? where CODE = ? 
2019-07-03 18:32:08.548 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : ==> Parameters: 日购电数据(String), 1(Integer), 3(String), 2016-11-09 15:54:39.0(Timestamp), 2019-07-04 03:30:00.0(Timestamp), N(String), Y(String), admin(String), 2016-11-09 17:40:51.0(Timestamp), 00000003(String)
2019-07-03 18:32:08.573 DEBUG 73664 --- [pool-1-thread-2] c.i.r.m.S.updateByPrimaryKeySelective    : <==    Updates: 1
2019-07-03 18:32:08.574  INFO 73664 --- [pool-1-thread-2] com.inhe.rpt.task.RptTask                : task finsih
2019-07-03 18:34:00.009  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:34:00.017 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:34:00.028 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:34:00.030 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:36:00.005  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:36:00.011 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:36:00.013 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:36:00.015 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:38:00.009  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:38:00.013 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:38:00.013 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:38:00.015 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:40:00.001  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:40:00.008 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:40:00.009 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:40:00.011 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:42:00.011  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:42:00.014 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:42:00.015 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:42:00.017 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
2019-07-03 18:44:00.004  INFO 73664 --- [threadPoolTaskScheduler-1] com.inhe.rpt.processor.RptProcessor      : handle task start
2019-07-03 18:44:00.008 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==>  Preparing: select CODE, DESCRIPTION, CYCLE, CYCLE_TYPE, BASE_TIME, STARTUP_TIME, EXECING, ACTIVED, COPERATOR, CDATE , PARAM from sys_report where EXECING='N' AND ACTIVED='Y' AND STARTUP_TIME <=NOW() 
2019-07-03 18:44:00.009 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : ==> Parameters: 
2019-07-03 18:44:00.010 DEBUG 73664 --- [threadPoolTaskScheduler-1] c.i.rpt.mapper.SysReportMapper.findTask  : <==      Total: 0
